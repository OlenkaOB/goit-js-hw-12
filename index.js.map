{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst showBox = new SimpleLightbox('.galleryEl a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.7,\n  className: 'lightbox',\n});\n\nexport const createGalleryMarkup = photos =>\n  photos\n    .map(\n      photo =>\n        `<li class=\"galleryEl\">\n    <a class=\"gallery-link\" href=\"${photo.largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${photo.webformatURL}\"\n          alt=\"${photo.tags}\"\n          title=\"${photo.tags}\"/>\n      </a>\n        <ul class=\"data-list\">\n          <li class=\"card-text\">\n            <h2 class=\"data-item-name\" >likes</h2>\n            <p class=\"data-numbers\">${photo.likes}</p>\n          </li>\n          <li class=\"card-text\">\n            <h2 class=\"data-item-name\">views</h2>\n            <p class=\"data-numbers\">${photo.views}</p>\n          </li>\n          <li class=\"card-text\">\n            <h2 class=\"data-item-name\">comments</h2>\n            <p class=\"data-numbers\">${photo.comments}</p>\n          </li>\n          <li class=\"card-text\">\n            <h2 class=\"data-item-name\">downloads</h2>\n            <p class=\"data-numbers\">${photo.downloads}</p>\n          </li>\n        </ul>\n      </li>`\n    )\n    .join('');\n","import axios from 'axios';\nexport const BASE_URL = 'https://pixabay.com/';\nexport const API_KEY = '46069997-68364f05efefbed8c9e798952';\n\nexport const PER_PAGE = 15;\nexport let currentPage = 1;\n\nexport async function fetchNews(query, currentPage) {\n  const options = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    pageSize: PER_PAGE,\n    page: currentPage,\n  };\n\n  const params = new URLSearchParams(options);\n\n  try {\n    const response = await axios.get(`${BASE_URL}api/?${params}`);\n    console.log(response.data);\n    return response.data;\n  } catch (error) {\n    console.error(error);\n    throw error;\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { createGalleryMarkup } from './js/render-functions';\nimport { PER_PAGE, fetchNews } from './js/pixabay-api';\n\nconst form = document.querySelector('form.js-search-form');\nconst gallery = document.querySelector('.gallery');\nconst btnLoader = document.querySelector('.btn-loader');\n\nlet currentPage = 1;\nlet query = null;\n\nconst showBox = new SimpleLightbox('.galleryEl a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.7,\n  className: 'lightbox',\n});\n\nfunction showLoader() {\n  document.getElementById('loader').style.display = 'block';\n}\n\nfunction hideLoader() {\n  document.getElementById('loader').style.display = 'none';\n}\n\nasync function onButtonSubmit(event) {\n  event.preventDefault();\n  currentPage = 1;\n  btnLoader.style.display = 'none';\n  showLoader();\n\n  const form = event.currentTarget;\n  const {\n    searchValue: { value: query },\n  } = form.elements;\n  console.log(query);\n\n  if (query === '') {\n    iziToast.show({\n      message: `⚠️ Please fill search input`,\n      position: 'topRight',\n      color: 'yellow',\n    });\n    hideLoader();\n    return;\n  }\n  gallery.innerHTML = '';\n  try {\n    const photos = await fetchNews(query);\n    if (!photos.hits || photos.hits.length === 0) {\n      iziToast.show({\n        title: '❌',\n        message: `\"Sorry, there are no images matching your search query. Please try again!\"`,\n        position: 'topRight',\n        color: 'red',\n      });\n      return;\n    }\n\n    gallery.insertAdjacentHTML('beforeend', createGalleryMarkup(photos.hits));\n    handleScrollView();\n    showBox.refresh();\n    if (photos.totalHits > 15) {\n      btnLoader.style.display = 'block';\n    }\n    return query;\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function btnLoaderClick() {\n  try {\n    showLoader();\n    currentPage += 1;\n    const photos = await queryFunction(query, currentPage);\n    console.log(currentPage);\n    let totalPages = Math.ceil(photos.totalHits / PER_PAGE);\n    console.log(totalPages);\n\n    if (currentPage >= totalPages) {\n      btnLoader.style.display = 'none';\n      iziToast.show({\n        title: '❌',\n        message: `\"We're sorry, but you've reached the end of search results.\"`,\n        position: 'bottomCenter',\n        color: 'blue',\n      });\n    }\n    gallery.insertAdjacentHTML('beforeend', createGalleryMarkup(photos.hits));\n    handleScrollView();\n    showBox.refresh();\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction handleScrollView() {\n  const lastArticle = gallery.lastElementChild;\n  const articleHeight = lastArticle.getBoundingClientRect().height;\n  const scrollHeight = articleHeight * 2;\n\n  window.scrollBy({\n    top: scrollHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nbtnLoader.addEventListener('click', btnLoaderClick);\nform.addEventListener('submit', onButtonSubmit);\n"],"names":["SimpleLightbox","createGalleryMarkup","photos","photo","BASE_URL","API_KEY","PER_PAGE","fetchNews","query","currentPage","options","params","response","axios","error","form","gallery","btnLoader","showBox","showLoader","hideLoader","onButtonSubmit","event","iziToast","handleScrollView","btnLoaderClick","totalPages","scrollHeight"],"mappings":"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"}